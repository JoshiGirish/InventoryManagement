{% extends "base.html" %}

    {% block title %}
    {% endblock %}

    {% block contents %}

    <div class="col-sm-12">
    <div id="carousel" class="carousel slide" data-ride="carousel" data-interval="false">
      <div class="carousel-inner">
        <div id="createCorousel" class="carousel-item active">
          <div class="d-flex flex-row" style="height: 900px;">
            {% if requested_view_type == 'create' %}
              {% include "sales_order/create_sales_order.html" %}
            {% elif requested_view_type == 'update' %}
              {% include "sales_order/update_sales_order.html" %}
            {% endif %}
          <div class="d-flex flex-column justify-content-center" style="width: 40px;">
            <div class="divider"></div>
            <a class="" href="#carousel" role="button" data-slide="next" onclick="getObjects(); toggleCorouselCookie();">
              <!-- <span class="carousel-control-next-icon" aria-hidden="true"></span> -->
              <span style="color: gray;"><i class="fas fa-angle-left fa-lg circle-icon"></i></span>
              <!-- <span class="sr-only">Next</span> -->
            </a>
            <div class="divider"></div>
          </div>
          
        </div>
        </div>
        <div id="displayCorousel" class="carousel-item">
          <div class="d-flex flex-row" style="height: 900px;">
            <div class="d-flex flex-column justify-content-center" style="width: 40px;">
              <div class="divider"></div>
              <a class="" href="#carousel" role="button" data-slide="prev" onclick="getObjects(); toggleCorouselCookie();">
                <!-- <span class="carousel-control-next-icon" aria-hidden="true"></span> -->
                <span style="color: gray;"><i class="fas fa-angle-right fa-lg circle-icon"></i></span>
                <!-- <span class="sr-only">Next</span> -->
              </a>
              <div class="divider"></div>
            </div>
            {% include "sales_order/sales_order_contents.html" %}
          </div>
        </div>
        </div>
      </div>
    </div>
    
    
      <script>
            // Set the corousel from the cookie
            var corouselState = getCookie('activeProductCorousel');
            if (corouselState=='create'){
              $('#displayCorousel').removeClass('active')
              $('#createCorousel').addClass('active')
              }
            else{
              $('#createCorousel').removeClass('active')
              $('#displayCorousel').addClass('active')
            }
            getObjects()
            function setCookie(name,value,days) {
                var expires = "";
                if (days) {
                    var date = new Date();
                    date.setTime(date.getTime() + (days*24*60*60*1000));
                    expires = "; expires=" + date.toUTCString();
                }
                document.cookie = name + "=" + (value || "")  + expires + "; path=/";
            }
            function getCookie(name) {
                var nameEQ = name + "=";
                var ca = document.cookie.split(';');
                for(var i=0;i < ca.length;i++) {
                    var c = ca[i];
                    while (c.charAt(0)==' ') c = c.substring(1,c.length);
                    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
                }
                return null;
            }
            function eraseCookie(name) {   
                document.cookie = name+'=; Max-Age=-99999999;';  
            }
    
            // Toggle the cookie
            function toggleCorouselCookie(){
              var corouselState = getCookie('activeProductCorousel');          
              if (corouselState=='create'){
                setCookie('activeProductCorousel','display',1)
              }
              else{
                setCookie('activeProductCorousel','create', 1)
              }
            }
    
            // Toogle the corousel
            function toggleCorousel(){
              var corouselState = getCookie('activeProductCorousel');          
              if (corouselState=='create'){
                setCookie('activeProductCorousel','display',1)
                $('#carousel').carousel("next")
              }
              else{
                setCookie('activeProductCorousel','create',1)
                $('#carousel').carousel("prev")
              }
            }
    
            function getObjects(){
              var searchParams = new URLSearchParams(window.location.search)
              $('#tableData').load("{% url 'sales_orders' %} #objTable", searchParams.toString());
            }
    
            $(document).keyup(function(e){
              var code = e.code || e.which;
              console.log(code)
              var corouselState = getCookie('activeProductCorousel');
              if (code == 'ArrowRight'){// left arrow key is pressed
                if(corouselState=='display'){
                  toggleCorousel();
                }
              }
              else if (code=='ArrowLeft'){// right arrow key is pressed
                if(corouselState=='create'){
                  toggleCorousel();
                }
              }
            });
      </script>
    {% endblock %}